<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
    <title>Admin</title>
    <style>
        #addPlace {
            background-color: #882c66;
            color: cornsilk;
        }

        h1 {
            color: #882c66;

        }
    </style>

</head>

<body class="text-center">
    <h1>Hi Admin</h1>
    <button class="btn btn-lg btn-block mt-3 mb-3" id="addPlace" type="submit" name="btn-login">add place</button>

    <div id="dataTable"></div>

    <main class="container justify-content-center">

        <h1 class="text-dark m-3">Places</h1>
        <div id="places" class="row">
        </div>

    </main>

    <script src="jquery-3.5.1.min.js"></script>
    <script>
        $('#addPlace').on('click', () => window.location.href = "/admin/add");
        // send http request to server


        fetch(`/places`, {
            method: 'GET',
            headers: { 'content-type': 'application/json; charset=UTF-8' },
        }).then(res => res.json())
            .then(data => {
                //$('#dataTable').html(JSON.stringify(data));
                //let dataArray = JSON.parse(data);
                //dataArray.forEach(value => alert("ok"));

                //for (var place in data) {
                //    display('#places'); // (place):
                //} 
                renderPlaces(data);

            });

/*
        class Location {
            constructor(name, city, postalCode, address, kitchen) {
                this.name = name;
                this.city = city;
                this.postalCode = postalCode;
                this.address = address;
                this.kitchen = kitchen;
            };

            display() {
                $('#places').append(`
				<div class="col-md-6 col-lg-3 mb-3">
					<div class="content col-12 rounded shadow text-dark pt-3 pb-3">
					${this.content()}
					</div>
				</div>
				`);
            };

            content() {
                return `
			<p class="text-dark font-weight-bold">${this.name}</p>
			<p class="mt-3 mb-0">${this.address.streetAddress + ", " + this.address.postalCode + " " + this.address.city}</p>
            <p class="mb-0">${this.kitchen}</p>
			`;
            };
        }
        */

        const renderPlace = (place) => {
          const category = place.liquids ? place.liquids : place.kitchen;
            console.log(place);
            return (
                `
				<div class="col-md-6 col-lg-3 mb-3">
					<div class="content col-12 rounded shadow text-dark pt-3 pb-3">
						<p class="text-dark font-weight-bold">${place.name}</p>
			            <p class="mt-3 mb-0">${place.address.streetAddress + ", " + place.address.postalCode + " " + place.address.city}</p>
                        <p class="mb-0">${category}</p>
                        <button>edit</button>
                        <button>delete</button>
					</div>
				</div>
				`
            )
        }

        const renderPlaces = (data) => {
            for (var place in data) {
                $('#places').append(renderPlace(data[place]));
            }
        }

    </script>
</body>

</html>